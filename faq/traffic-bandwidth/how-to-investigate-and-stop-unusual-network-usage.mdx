---
title: "How to Investigate and Stop Unusual Network Usage on Linux"
sidebarTitle: "* Detect Unusual Network Usage"
description: "Your VPS may start showing abnormal network usage because of hidden background processes â€” from rogue scripts and crypto miners to misbehaving cron jobs. Learn how to find and stop them before they impact performance."
slug: "investigate-stop-unusual-network-usage-linux"
---

# Detecting Suspicious Network Spikes in Linux Servers ðŸš¨

Unusual network spikes often come from background activity you donâ€™t expect â€” hidden tasks or processes quietly using your bandwidth, such as:

- **Rogue scripts:** hidden or leftover commands constantly transferring data.  
- **Crypto miners:** unauthorized software using your serverâ€™s CPU and network for mining.  
- **Misbehaving processes:** normal services stuck in loops or retries, flooding the network.

Spotting these early helps you prevent wasted data, slow performance, and unexpected network costs.
   
ðŸ“˜ **Related:** Learn the difference between *traffic* and *bandwidth* in [this EDBB guide](https://docs.edbb.com/faq/traffic-bandwidth/traffic-vs-bandwidth).  

---

## 1) Monitor Live Network Activity

Start by checking which IPs or processes are using your network. Two lightweight tools are `iftop` and `nload`.

Before running them, make sure youâ€™re using the correct network interface â€”  
itâ€™s not always `eth0` (it can be `ens3`, `ens18`, `eno1`, etc.).  
You can find your active interface by running:

```bash
ip -o link show up | awk -F': ' '{print $2}'
```

Then replace `eth0` in the commands below with your interface name:

```bash
sudo apt install iftop nload -y
sudo iftop -i eth0
```

In **iftop**, youâ€™ll see source/destination IPs, ports, and data rates.  
Look for unknown or suspicious external IPs constantly sending or receiving data.

![iftop top talkers](/assets/iftop-test.png)
*iftop: quick view of top talkers (IP + rate).*

If you want a simpler graph view:

```bash
sudo nload eth0
```

![nload graph](/assets/nload-test.png)

---

## 2) Identify Which Process Is Behind the Network Usage

Once you spot unusual network activity, use `ss` (modern) or `netstat` (optional) to find the process behind the connections.

```bash
# recommended (modern tool)
sudo ss -tupn
```

If you prefer `netstat`, install `net-tools` first:

```bash
sudo apt install net-tools -y
sudo netstat -tupn
```

Based on the screenshot below, you can see how each process (identified by its **PID**) connects to remote hosts.  
For example, a process like `xray-linux-amd6` with PID `28799` is making outbound connections to multiple external IPs â€” a strong sign of a background service or script consuming network bandwidth.

![ss and netstat example screenshot](/assets/tunpn-tests.png)
ðŸ’¡ *`ss` / `netstat` output shows which PIDs are opening remote connections and potentially causing abnormal network usage.*

---

## 3) Inspect the Suspicious Process

Now that youâ€™ve identified the suspicious PID from **`ss`** or **`netstat`**, check what it actually is and where itâ€™s running from.

```bash
ps aux | grep 28799
ls -l /proc/28799/exe
strings /proc/28799/cmdline
```

ðŸ’¡ *Replace **`28799`** with the PID of the process you found suspicious in the previous step.*

If you notice the executable path pointing to directories like **`/tmp/`**, **`/dev/shm/`**, or **`/var/tmp/`**,  
itâ€™s often a rogue or crypto-mining script â€” legitimate system services rarely run from those paths.

| ![proc exe](/assets/proc-exe.png) | ![proc cmdline](/assets/proc-cmdline.png) |
|:--:|:--:|
|Check process binary path.|Check full cmdline for execution arguments.|

---

## 4) Kill and Quarantine the Script

Stop the suspicious process immediately (replace **28799** with your PID):

```bash
sudo kill -9 28799
```

Before deleting, back up the executable for later analysis:

```bash
sudo cp /proc/28799/exe /root/suspicious_exe_backup || true
sudo rm -rf /usr/local/x-ui/bin/xray-linux-amd64 /tmp/.miner /var/tmp/.hidden || true
```

| ![network before](/assets/iftop-test.png) | ![network after](/assets/after-kill.png) |
|:--:|:--:|
|Network usage before stopping process.|Network usage after stopping â€” activity drops.|

---

## 5) Check Cron Jobs and Autostart Entries

Many rogue scripts try to restart automatically after reboot using cron or startup files.  
Inspect the following locations carefully:

```bash
crontab -l
sudo cat /etc/crontab
sudo ls /etc/cron.d/
sudo cat /etc/rc.local
```

Also check these common paths:

```text
/etc/systemd/system/
/etc/init.d/
/home/*/.bashrc
/home/*/.profile
```

If you find a suspicious entry like this:

```bash
@reboot sleep 30 && /usr/local/x-ui/bin/xray-linux-amd64 -c /usr/local/x-ui/config.json >/dev/null 2>&1 &
```

or something referencing temporary paths:

```bash
@reboot /tmp/.miner/start.sh
```

remove it immediately, as it will automatically restart the rogue process every time the system boots.

ðŸ’¡ *Tip:* Legitimate cron jobs usually run system maintenance tasks (like backups or log rotations) â€” anything starting from `/tmp`, `/dev/shm`, or `/var/tmp` is highly suspicious.

---

## 6) Use nethogs for Per-Process Network Tracking

To continuously monitor which processes use the most network bandwidth:

```bash
sudo apt install nethogs -y
sudo nethogs
```

Youâ€™ll see a live list of processes with **sent** and **received** rates â€” perfect for spotting anomalies before they grow.

![nethogs live view](/assets/nethogs-test.png)
*nethogs: per-process network usage in real time.*

---

## 7) Check Your Overall Network Usage

If you suspect something has already used too much data, review your usage stats directly in the EDBB portal.  
It shows **total monthly usage**, **daily graphs**, and **refill times**.

ðŸ“˜ [Learn how EDBB measures network usage and refill cycles here](https://docs.edbb.com/faq/traffic-bandwidth/traffic-stats-refill-explained).

---

## 8) Harden the System Against Rogue Scripts ðŸ›¡ï¸

After removing the rogue process, secure your server to prevent it from coming back.

- **If `/tmp` or `/var/tmp` are separate mounts, disable script execution:**
  ```bash
  sudo mount -o remount,noexec /tmp
  sudo mount -o remount,noexec /var/tmp || true
  ```

- **If you get â€œmount point not mountedâ€ error:**  
  it means `/tmp` isnâ€™t a separate mount. Use this safer alternative:
  ```bash
  sudo mount -o bind /tmp /tmp
  sudo mount -o remount,noexec,nosuid /tmp
  ```

- **Limit outbound connections:**  
  Use `ufw` or `iptables` to block unknown processes from sending data.

- **Find recently changed files (possible rogue scripts):**
  ```bash
  sudo find / -mtime -1 -type f 2>/dev/null
  ```

- **Check SSH login attempts:**
  ```bash
  sudo journalctl -u ssh | grep "Failed password"
  ```

ðŸ’¡ *Tip:* You can also follow our detailed [SSH Security Hardening Guide](../../ssh-security-hardening-guide)  
for advanced protection steps such as disabling root login, changing default SSH ports, and setting up fail2ban.

---

âœ… Following these steps ensures your VPS stays stable, secure, and free from hidden processes consuming network resources or performance.
